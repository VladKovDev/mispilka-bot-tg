# Папка data

Эта папка содержит данные работы бота. Все файлы формата JSON.

## Структура

- `example/` - Примеры конфигурационных файлов для разных ботов. Содержимое этой папки отслеживается в git.
  - `messages/` - Примеры текстов сообщений в формате Markdown.
  - `assets/images/` - Пример изображений для сообщений.
- `messages/` - Тексты сообщений в формате Markdown. Не отслеживается в git.
- `assets/images/` - Изображения для сообщений. Создаётся вручную на сервере. Не отслеживается в git.
- `messages.json` - Настройка очереди сообщений. Не отслеживается в git.
- `users.json` - База пользователей. Автоматически создается ботом. Не отслеживается в git.
- `schedule_backup.json` - Бэкап расписания. Автоматически создается ботом. Не отслеживается в git.

## Настройка нового бота

При настройке нового бота или обновлении системы:

1. **Скопируйте примеры из папки `example/`:**
   ```bash
   cp data/example/messages.json data/messages.json
   cp -r data/example/messages data/messages
   ```

2. **Создайте папку для изображений:**
   ```bash
   mkdir -p data/assets/images
   ```

3. **Настройте `messages.json`:**
   ```json
   {
     "messages_list": ["msg1", "msg2", "msg3"],
     "messages": {
       "msg1": {
         "timing": {"hours": 0, "minutes": 0},
         "template_file": "msg1.md",
         "inline_keyboard": {
           "rows": [
             {
               "buttons": [
                 {"type": "url", "text": "Button", "url": "{{payment_link}}"}
               ]
             }
           ]
         }
       }
     }
   }
   ```
   - `messages_list` - очередь сообщений (обрабатывается с конца)
   - `timing` - задержка перед отправкой следующего сообщения `{hours, minutes}`
   - `template_file` - имя файла с текстом сообщения в папке `messages/`
   - `inline_keyboard` - конфигурация инлайн-кнопок (опционально)

4. **Создайте файлы с текстом сообщений в `data/messages/`:**
   - Имена файлов должны соответствовать ключам из `messages.json`
   - Поддерживаются плейсхолдеры в формате `{{placeholder}}`:
     - `{{payment_price}}` - цена продукта из конфига
     - `{{payment_link}}` - уникальная ссылка на оплату пользователя
     - `{{invite_link}}` - уникальная ссылка на приглашение в группу

5. **При необходимости добавьте фото для сообщений:**
   - Создайте папку `data/assets/images/` (если ещё не создали)
   - Изображения должны находиться в `data/assets/images/{message_name}.PNG`
   - Расширение должно быть `.PNG` (заглавные буквы)
   - Пример: для сообщения `welcome` нужен файл `data/assets/images/welcome.PNG`

## Особые сообщения

- `start` - Начальное сообщение, отправляемое после команды `/start`
- `group_invite` - Сообщение с приглашением в группу после успешной оплаты

## Заметки

- Все файлы в `data/` (кроме `example/` и этого `README.md`) не отслеживаются в git, чтобы избежать конфликтов при обновлениях
- При обновлении системы сохраните свои изменения в `data/messages.json`, `data/messages/` и `data/assets/images/`, так как они могут быть перезаписаны
- `users.json` и `schedule_backup.json` автоматически управляются ботом
- Папка `data/assets/images/` должна быть создана вручную на сервере для работы с изображениями
